# -*- coding: utf-8 -*-
"""Cricket_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1cHvpb86nPzIqDmrc2e1Quc2HiyPatZm6
"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

data = pd.read_csv('match_data.csv')
data.head(4)

data.columns

##Cleaning
data.isna().sum()

data.hist(bins=30, figsize=(15, 10))

data.boxplot(figsize=(15, 10))
## here we see that there are outliers only in pid which is inconsequential

####Cleaning complete####

## adding date to another

dt = data.groupby(data['match_name'])
dt.groups.keys()

data['match_name'].unique

data.size

data.dtypes

## Converting objects to strings

data = data.astype({'team_name':'string'})

data = data.astype({'team1_name':'string'})
data = data.astype({'team2_name':'string'})
data = data.astype({'match_name':'string'})
data = data.astype({'name':'string'})

data.dtypes

## generating target variable
data['winner'] = np.where(
    data['team1_score'] > data['team2_score'], data['team1_name'], np.where(
    data['team2_score'] >  data['team1_score'], data['team2_name'], "Tie"))

data.head(4)

## dropping url
data = data.drop(['url'], axis=1)

